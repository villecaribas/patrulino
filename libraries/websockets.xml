<blocks app="Snap! 11-250620-dev, https://snap.berkeley.edu" version="2"><palette><category name="WebSockets" color="0,209,84,1"/></palette><block-definition s="__init websockets extension__" type="command" category="WebSockets" helper="true"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doSetVar"><l>__websocket__message__</l><l></l></block><block s="doSetVar"><l>__module__websockets__</l><l>libraries/websockets/init.js</l></block></script></block-definition><block-definition s="connect to %&apos;address&apos;" type="command" category="WebSockets"><header></header><code></code><translations></translations><inputs><input type="%s" initial="1">wss://myserver.com</input></inputs><script><block s="doDeclareVariables"><list><l>start</l></list></block><block s="doSetVar"><l>start</l><block s="reportDate"><l><option>time in milliseconds</option></l></block></block><block s="doApplyExtension"><l>var_declare(scope, name)</l><list><l>sprite</l><l>__websocket__message__</l></list></block><block s="doApplyExtension"><l>ide_hide(block)</l><list><block s="reifyReporter"><autolambda><block var="__websocket__message__"/></autolambda><list></list></block></list></block><block s="doSetVar"><l>__websocket__message__</l><l></l></block><block s="doApplyExtension"><l>ws_connect(address)</l><list><block var="address"/></list></block><block s="doWaitUntil"><block s="reportVariadicOr"><list><custom-block s="connected?"></custom-block><block s="reportVariadicGreaterThan"><list><block s="reportDate"><l><option>time in milliseconds</option></l></block><block s="reportVariadicSum"><list><block var="start"/><l>2000</l></list></block></list></block></list></block></block><block s="doIf"><custom-block s="connected?"></custom-block><script><block s="doApplyExtension"><l>ws_onreceive(callback)</l><list><block s="reifyScript"><script><block s="doSetVar"><l>__websocket__message__</l><block var="message"/></block></script><list><l>message</l></list></block></list></block></script><list><l><bool>true</bool></l><script><custom-block s="disconnect"></custom-block><block s="doApplyExtension"><l>err_error(msg)</l><list><block s="reportJoinWords"><list><l>Timed out when trying to connect to </l><block var="address"/><block s="reportUnicodeAsLetter"><l>10</l></block><l>Make sure the protocol, address and port are correct.</l></list></block></list></block></script></list></block></script></block-definition><block-definition s="connected?" type="predicate" category="WebSockets"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="reportApplyExtension"><l>ws_connected()</l><list></list></block></block></script></block-definition><block-definition s="disconnect" type="command" category="WebSockets"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doApplyExtension"><l>ws_disconnect()</l><list></list></block></script></block-definition><block-definition s="send %&apos;message&apos;" type="command" category="WebSockets" space="true"><header></header><code></code><translations></translations><inputs><input type="%s" initial="1">Hello, socket!</input></inputs><script><block s="doIf"><block s="reportApplyExtension"><l>ws_connected()</l><list></list></block><script><block s="doApplyExtension"><l>ws_send(message)</l><list><block var="message"/></list></block></script><list></list></block></script></block-definition><block-definition s="when I receive %&apos;message&apos;" type="hat" category="WebSockets" space="true"><header></header><code></code><translations></translations><inputs><input type="%upvar" initial="1"></input></inputs><script><block s="doSetVar"><l>message</l><block var="__websocket__message__"/></block><block s="doSetVar"><l>__websocket__message__</l><l></l></block><block s="doReport"><block s="reportVariadicNotEquals"><list><block var="message"/><l></l></list></block></block></script></block-definition><variables><variable name="__module__websockets__" hidden="true"><l>libraries/websockets/init.js</l></variable></variables></blocks>